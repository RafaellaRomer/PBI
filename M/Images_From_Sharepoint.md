### CODE GENERATED BY "SPECIFY DATA" BOTTOM

STEP 1 - Create a table with the column with the text value and anotjer one with the sharepoint path > 
    >> this will create a json document as "Source" / "Origen" (find in teh code "// ENDS OF THE JSON STATMENT GENERATED AUTOMATICALLY")
STEP 2 - Add a column using **WEB.CONTENTS([Column Name])** function
STEP 3 - Add a column using **BINARY.TOTEXT([Column Name],  BinaryEncoding.Base64)** function + concat with the text in the beginning: **"data:image/png;base64, "**
```
let
Origen = Table.FromRows(
Json.Document(
    Binary.Decompress(
    Binary.FromText(xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx),
     BinaryEncoding.Base64), 
    Compression.Deflate)
    ), 
      let
          _t = ((type nullable text) meta [Serialized.Text = true]
) 
      in
          type table [Tipo = _t, Icon = _t]), // ENDS OF THE JSON STATMENT GENERATED AUTOMATICALLY

web_contents = Table.AddColumn(Origen, "ICON_BINARIO", each Web.Contents([Icon])),
binarytotext = Table.AddColumn(web_contents, "icon2", each "data:image/png;base64, " & Binary.ToText([ICON_BINARIO], BinaryEncoding.Base64))

in
    binarytotext
````

### CODE GENERATED BY ACCESSING SHAREPOINT LIBRARY

```
let
    // STEP 1 — List your image links and types here
    Images = {
        {"General", "https://company.sharepoint.com/sites/.../general.png"},
        {"Warning", "https://company.sharepoint.com/sites/.../warning.png"},
        {"Success", "https://company.sharepoint.com/sites/.../success.png"}
    },

    // STEP 2 — Convert the list to a table
    SourceTable = #table({"TYPE", "URL"}, Images),

    // STEP 3 — Add a column that fetches each image as binary
    AddBinary = Table.AddColumn(SourceTable, "Binary", each try Web.Contents([URL]) otherwise null),

    // STEP 4 — Convert the binary to Base64 text
    AddBase64 = Table.AddColumn(AddBinary, "Base64", each try Binary.ToText([Binary], BinaryEncoding.Base64) otherwise null),

    // STEP 5 — Add the HTML-friendly prefix
    AddDataURI = Table.AddColumn(AddBase64, "ImageURI", each "data:image/png;base64," & [Base64]),

    // STEP 6 — Select only what you need in the final table
    Result = Table.SelectColumns(AddDataURI, {"TYPE", "ImageURI"})
in
    Result
````

1️⃣ Get the original image

The image is stored in SharePoint, OneDrive, or another location.

Copy the direct link to the file (example:
https://company.sharepoint.com/sites/.../icon.png).

⚠️ Important: The link must point to the actual file (not the preview page).
If you open it in your browser and only the image appears (without the SharePoint interface), that’s the correct link.

2️⃣ Create a new query in Power Query

In Power BI:

Go to Home > Get Data > Blank Query.

Click View > Advanced Editor.

Paste this code:

let
    // Replace the link below with the actual image path
    Source = Web.Contents("https://company.sharepoint.com/sites/.../icon.png")
in
    Source


Click Done.

3️⃣ Convert the binary to Base64

Power Query will download the binary content of the image.
Now, add a custom step to convert it to Base64 text:

let
    Source = Web.Contents("https://company.sharepoint.com/sites/.../icon.png"),
    Base64 = Binary.ToText(Source, BinaryEncoding.Base64)
in
    Base64


Result:
You’ll see a long text starting with iVBORw0KGgoAAAANSUhEUg... — that’s the image content in Base64.
This is exactly the same code your colleague used.

4️⃣ (Optional) Embed it in a table

If you want to build a table containing this icon (for example, several types and their icons):

let
    Icon = Binary.ToText(Web.Contents("https://company.sharepoint.com/sites/.../icon.png"), BinaryEncoding.Base64),
    Table = #table(
        {"TYPE", "ICON"},
        {
            {"General", Icon}
        }
    )
in
    Table


Now you have a table like this:

TYPE	ICON
General	iVBORw0KGgoAAAANSUh...
5️⃣ (Optional) Create a column with the prefix data:image/png;base64,

This allows you to display the image in HTML visuals or custom visuals:

let
    Icon = Binary.ToText(Web.Contents("https://company.sharepoint.com/sites/.../icon.png"), BinaryEncoding.Base64),
    Table = #table(
        {"TYPE", "ICON"},
        {
            {"General", "data:image/png;base64," & Icon}
        }
    )
in
    Table

6️⃣ (Optional) Compress it

If you want the code in a compact format using
Binary.Decompress(Binary.FromText(...)):

Load the ready-made table (for example, the one above).

In the Power Query Editor:

Right-click the query.

Choose Copy > Copy M code.

Paste the result into another editor — Power Query automatically converts the data into a compressed block, just like the one you saw.

✅ Result

You’ll have a query that:

Embeds the image directly in the M code (no SharePoint dependency).

Can be used in HTML columns or custom Power BI cards.

If you copy the M code, it will generate that long
Binary.Decompress(Binary.FromText(...)) block.
